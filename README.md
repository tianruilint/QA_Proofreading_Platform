# QA对校对协作平台

一个基于Web的文本校对系统，支持访客模式和用户登录模式，具备JSONL文件上传、编辑、保存、导出等功能。

## 🚀 快速开始

### 环境要求
- Python 3.11+
- Node.js 20+
- 现代浏览器

### 安装和运行

1. **安装后端依赖**
```bash
pip3 install -r requirements.txt
```

2. **初始化数据库**
```bash
python3 init_sqlite_db.py
```

3. **启动后端服务**
```bash
python3 src/main.py
```

4. **安装前端依赖**
```bash
cd frontend
npm install --legacy-peer-deps
```

5. **启动前端服务**
```bash
npm run dev
```

6. **访问应用**
打开浏览器访问：http://localhost:5173

## ✨ 主要功能

### 访客模式
- 🔓 无需登录即可使用
- 📁 JSONL文件上传和解析
- ✏️ QA对在线编辑
- 📄 分页显示（每页5个QA对）
- 💾 JSONL和Excel格式导出
- 🎯 页面高度固定，无垂直滚动

### 登录模式
- 👤 用户身份验证
- 📊 左侧导航和右侧工作台并列布局
- 📝 会话历史记录管理
- 🗑️ 会话删除功能
- ⏰ 编辑时间记录（北京时间）
- 👥 多用户协作支持

## 🎯 核心特性

### 界面设计
- **响应式布局**：适配不同屏幕尺寸
- **固定高度**：页面保持在标准浏览器大小内
- **左右分栏**：登录模式下左侧导航，右侧工作台
- **翻页模式**：避免长页面滚动，提升用户体验

### 文件处理
- **JSONL格式支持**：标准的JSON Lines格式
- **实时编辑**：所见即所得的编辑体验
- **多格式导出**：支持JSONL和Excel格式
- **数据持久化**：登录用户数据保存到数据库

### 用户体验
- **即时反馈**：编辑状态实时显示
- **操作提示**：清晰的用户操作指引
- **错误处理**：友好的错误提示和处理
- **性能优化**：快速响应和流畅交互

## 📁 项目结构

```
qa-proofreading-platform-optimized/
├── src/                          # 后端源码
│   ├── main.py                  # Flask应用入口
│   ├── routes/                  # API路由
│   │   ├── auth.py             # 用户认证
│   │   └── file_management.py  # 文件管理
│   ├── models/                  # 数据模型
│   │   ├── user.py             # 用户模型
│   │   └── single_file.py      # 文件会话模型
│   └── utils/                   # 工具函数
│       └── file_handler.py     # 文件处理工具
├── frontend/                     # 前端源码
│   ├── src/                     # React源码
│   │   ├── components/          # React组件
│   │   │   ├── LoginPage.jsx   # 登录页面
│   │   │   ├── MainLayout.jsx  # 主布局
│   │   │   └── SingleFileEditor.jsx # 文件编辑器
│   │   ├── lib/                # 工具库
│   │   │   └── api.js          # API接口
│   │   └── App.jsx             # 应用入口
│   ├── package.json            # 前端依赖
│   └── vite.config.js          # Vite配置
├── requirements.txt             # 后端依赖
├── init_sqlite_db.py           # 数据库初始化
├── 修复优化报告.md              # 详细修复报告
├── 部署测试指南.md              # 部署和测试指南
└── README.md                   # 项目说明
```

## 🔧 技术栈

### 后端
- **Flask**：Python Web框架
- **SQLAlchemy**：ORM数据库操作
- **SQLite**：轻量级数据库
- **openpyxl**：Excel文件处理

### 前端
- **React**：用户界面库
- **Vite**：构建工具
- **Tailwind CSS**：样式框架
- **Lucide React**：图标库

## 📋 使用说明

### 访客模式使用流程

1. **进入访客模式**
   - 点击登录页面的"跳过登录（访客模式）"按钮

2. **上传JSONL文件**
   - 点击"选择文件"按钮
   - 选择符合格式的JSONL文件
   - 系统自动解析并显示QA对

3. **编辑QA对**
   - 点击任意QA对的"编辑"按钮
   - 修改问题或答案内容
   - 点击"保存"确认修改

4. **分页浏览**
   - 使用页面底部的分页控件
   - 每页显示5个QA对
   - 支持快速跳转到指定页面

5. **导出文件**
   - 点击"导出JSONL"下载原格式文件
   - 点击"导出Excel"下载表格文件

### JSONL文件格式

每行一个JSON对象，包含question和answer字段：

```jsonl
{"question": "什么是人工智能？", "answer": "人工智能是计算机科学的一个分支..."}
{"question": "什么是机器学习？", "answer": "机器学习是人工智能的一个子集..."}
```

## 🐛 问题排查

### 常见问题

1. **访客模式按钮无响应**
   - 检查浏览器控制台错误
   - 确认前后端服务都已启动

2. **文件上传失败**
   - 检查文件格式是否为JSONL
   - 确认文件内容符合JSON格式
   - 检查文件大小不超过10MB

3. **页面布局异常**
   - 刷新浏览器页面
   - 尝试使用不同浏览器
   - 检查浏览器缩放比例

4. **导出功能无响应**
   - 检查浏览器下载设置
   - 确认后端服务正常运行
   - 查看浏览器控制台错误

### 调试信息

- **后端日志**：在运行后端服务的终端查看
- **前端日志**：打开浏览器开发者工具Console
- **数据库**：SQLite文件位于项目根目录

## 📝 更新日志

### v1.0.0 (2025-07-13)
- ✅ 修复访客模式按钮无法点击问题
- ✅ 优化登录用户界面布局为左右并列
- ✅ 实现工作台翻页模式，每页显示5个QA对
- ✅ 确保页面高度固定在标准浏览器大小内
- ✅ 优化文件导出功能，Excel直接导出单个文件
- ✅ 完善用户体验和界面设计
- ✅ 添加详细的部署和测试文档

## 📄 许可证

本项目仅供学习和研究使用。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进项目。

## 📞 技术支持

如有问题，请查看：
1. `修复优化报告.md` - 详细的修复说明
2. `部署测试指南.md` - 完整的部署和测试指南
3. 项目Issue页面 - 常见问题和解决方案

