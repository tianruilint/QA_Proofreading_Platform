# QA对校对协作平台 - 产品需求文档(PRD)

## 1. 文档信息
- **文档版本**: V1.0
- **创建日期**: 2025-01-08
- **产品名称**: QA对校对协作平台
- **文档状态**: 初稿

## 2. 产品概述

### 2.1 产品背景
在QA对生成过程中，由于自动生成的内容可能存在质量问题，需要人工进行清洗和校对。当QA对数量较大时，单人难以完成全部校对工作，需要多人协作完成。

### 2.2 产品定位
一个轻量级的内部协作工具，用于多人协同校对和处理JSONL格式的QA对文件，提供可视化编辑、任务分配、进度追踪等功能。

### 2.3 目标用户
内部团队成员，需要对大量QA对进行人工校对和质量控制的工作人员。

### 2.4 核心价值
- 提高QA对校对效率
- 支持多人协作，合理分配工作量
- 可视化编辑界面，降低操作难度
- 进度追踪，确保任务完成质量

## 3. 功能需求

### 3.1 用户登录系统

#### 3.1.1 功能描述
- 简化的用户系统，基于姓名进行身份识别
- 支持跳过登录的访客模式

#### 3.1.2 功能详情
**登录模式**：
- 用户从预设的姓名列表中选择自己的姓名进行登录
- 登录后可使用完整功能（功能1、2、3）
- 用户列表由管理员在后端预先配置

**访客模式**：
- 点击"跳过登录"进入访客模式
- 仅可使用功能1（单机版功能）
- 不保存任何数据到后端，仅在前端临时存储
- 操作完成后立即清除缓存

### 3.2 功能1：单文件QA对校对

#### 3.2.1 功能描述
上传JSONL文件，可视化展示QA对内容，支持在线编辑和导出。

#### 3.2.2 功能详情
**文件上传**：
- 支持上传JSONL格式文件
- 文件格式验证：每行必须是有效的JSON对象，包含"prompt"和"completion"字段

**可视化展示**：
- 将每个QA对以卡片形式展示（如有更好设计也可以采用）
- 每个prompt和completion分别显示在独立的文本框中
- 文本框支持直接编辑修改
- 显示当前QA对的序号和总数
- 支持分页展示（建议每页显示20-50个QA对）

**保存功能**：
- 点击"保存"按钮，将编辑后的内容导出为JSONL文件
- 保持原有格式：每行一个JSON对象
- 文件命名规则：原文件名_edited_时间戳.jsonl

**Excel转换功能**：
- 点击"转换为Excel"按钮
- 将当前编辑后的内容转换为Excel格式
- Excel格式要求：
  - 第一列：prompt（问题）
  - 第二列：completion（答案）
  - 首行为表头
- 文件命名规则：原文件名_时间戳.xlsx

### 3.3 功能2：多人协作任务分配

#### 3.3.1 功能描述
将大文件拆分成多个子任务，分配给团队成员协同完成。

#### 3.3.2 功能详情
**任务创建与分配**：
- 上传文件后，可选择"创建协作任务"
- 分配方式：
  - 平均分配：系统自动将QA对平均分配给选中的用户
  - 自定义分配：手动指定每个用户负责的QA对数量或范围
- 用户选择：从用户列表中勾选参与协作的成员
- 任务创建者自己也会被分配部分QA对

**任务管理**：
- 每个协作任务生成唯一ID
- 记录任务信息：
  - 原文件名
  - 创建时间
  - 创建者
  - 参与人员列表
  - 各成员负责范围

**进度追踪**：
- 实时显示任务完成进度
- 进度展示方式：
  - 总体进度条
  - 各成员完成状态（未开始/进行中/已完成）
  - 已完成人数/总人数

**任务提交**：
- 成员完成自己的部分后，点击"提交"按钮
- 可以重复提交，以最后一次为准
- 若成员有QA对删除操作，以成员最后版本为准
- 系统记录提交时间和状态
- 创建者可查看各成员提交状态

**任务完成**：
- 所有成员（包括创建者）都提交后，任务标记为已完成
- 创建者可下载合并后的完整文件
- 支持JSONL和Excel两种格式导出

### 3.4 功能3：任务列表管理

#### 3.4.1 功能描述
展示用户的所有待办和已完成任务。

#### 3.4.2 功能详情
**待办任务列表**：
- 显示位置：页面左侧边栏
- 列表内容：
  - 自己上传的文件（单人任务）
  - 他人分配的协作任务
- 显示信息：
  - 文件名/任务名
  - 任务类型（个人/协作）
  - 如果是协作任务，显示发送人姓名
  - 创建时间
  - QA对数量（协作任务只显示分配给自己的部分）

**已完成任务**：
- 任务完成后移入已完成列表
- 保留时间：24小时后自动删除
- 在保留期内可重新下载

**数据隔离**：
- 协作任务中，用户只能看到分配给自己的QA对部分
- 无法查看其他成员的编辑内容
- 仅任务创建者可查看和下载完整文件

### 3.5 数据管理与存储

#### 3.5.1 登录用户数据管理
- 所有操作数据保存到后端
- 支持任务暂存，可随时继续编辑
- 24小时后自动清理已完成任务

#### 3.5.2 访客模式数据管理
- 仅在浏览器本地临时存储
- 不与后端交互
- 关闭页面或完成下载后立即清除

## 4. 非功能需求

### 4.1 性能需求
- 单文件支持处理30000+条QA对
- 页面加载时间 < 3秒
- 文件上传/下载响应时间 < 5秒

### 4.2 兼容性需求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 响应式设计，支持平板设备操作
- 将会部署至公司内网，无需公网访问
- 3090服务器，ubuntu系统

### 4.3 安全性需求
- 文件传输使用HTTPS加密
- 用户间数据隔离
- 定期清理过期数据

### 4.4 可用性需求
- 界面简洁直观，无需培训即可上手
- 错误提示清晰明确
- 支持批量操作（如批量修改、查找替换、直接删除）

## 5. 界面设计要求

### 5.1 整体布局
- 顶部：导航栏（Logo、用户信息、退出登录）
- 左侧：任务列表（可折叠）
- 中间：主工作区（文件上传、QA对编辑）
- 底部：操作按钮区（保存、转换、分配等）

### 5.2 交互设计
- 拖拽上传文件
- 键盘快捷键支持（如Ctrl+S保存）
- 自动保存功能（每5分钟自动保存草稿）
- 编辑时的实时字数统计

## 6. 技术建议

### 6.1 前端技术栈
- React/Vue.js 构建单页应用
- Ant Design/Element UI 组件库
- Monaco Editor 或类似的代码编辑器组件

### 6.2 后端技术栈
- Node.js/Python FastAPI
- PostgreSQL/MySQL 数据库
- Redis 缓存

### 6.3 文件处理
- 使用流式处理大文件
- 前端分页加载，避免一次性加载全部数据

## 7. 风险与应对

### 7.1 技术风险
- **大文件处理性能问题**：采用分页加载和流式处理
- **并发编辑冲突**：实施乐观锁机制

### 7.2 使用风险
- **误操作导致数据丢失**：提供撤销/恢复功能，定期自动保存
- **权限管理简单**：后续可升级为更完善的权限系统

## 8. 附录

### 8.1 JSONL文件格式示例
```json
{"prompt": "设摊审批需要通过哪个系统进行？", "completion": "设摊审批需要通过教工OA系统进行。"}
{"prompt": "借用书院功能性用房的钥匙归还时间限制是什么？", "completion": "借用书院功能性用房的钥匙需在借用当天20:00前归还。"}
```

### 8.2 Excel文件格式示例
| 序号 | 问题(prompt) | 答案(completion) |
|------|--------------|------------------|
| 1 | 设摊审批需要通过哪个系统进行？ | 设摊审批需要通过教工OA系统进行。 |
| 2 | 借用书院功能性用房的钥匙归还时间限制是什么？ | 借用书院功能性用房的钥匙需在借用当天20:00前归还。 |