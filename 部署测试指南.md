# QA对校对协作平台 - 部署测试指南

## 快速开始

### 系统要求
- **操作系统**：Linux/macOS/Windows
- **Python**：3.11 或更高版本
- **Node.js**：20.0 或更高版本
- **浏览器**：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+

### 项目结构
```
qa-proofreading-platform-optimized/
├── src/                    # 后端源码
│   ├── main.py            # 后端入口文件
│   ├── routes/            # API路由
│   ├── models/            # 数据模型
│   └── utils/             # 工具函数
├── frontend/              # 前端源码
│   ├── src/               # React源码
│   ├── package.json       # 前端依赖
│   └── vite.config.js     # Vite配置
├── requirements.txt       # 后端依赖
├── init_sqlite_db.py     # 数据库初始化脚本
└── README.md             # 项目说明
```

## 部署步骤

### 1. 环境准备

#### 安装Python依赖
```bash
cd qa-proofreading-platform-optimized
pip3 install -r requirements.txt
```

#### 安装Node.js依赖
```bash
cd frontend
npm install --legacy-peer-deps
```

### 2. 数据库初始化

```bash
# 在项目根目录执行
python3 init_sqlite_db.py
```

### 3. 启动服务

#### 启动后端服务（端口5001）
```bash
# 在项目根目录执行
python3 src/main.py
```

#### 启动前端服务（端口5173）
```bash
# 在frontend目录执行
cd frontend
npm run dev
```

### 4. 访问应用

打开浏览器访问：http://localhost:5173

## 功能测试指南

### 访客模式测试

#### 1. 访问访客模式
1. 打开 http://localhost:5173
2. 点击"跳过登录（访客模式）"按钮
3. 验证成功跳转到访客模式页面

#### 2. 文件上传测试
1. 准备测试JSONL文件（参考下方示例）
2. 点击"选择文件"按钮
3. 选择JSONL文件上传
4. 验证文件解析成功，显示QA对列表

#### 3. 编辑功能测试
1. 点击任意QA对的"编辑"按钮
2. 修改问题或答案内容
3. 点击"保存"按钮
4. 验证修改内容已保存

#### 4. 分页功能测试
1. 上传包含多个QA对的文件（建议10个以上）
2. 验证每页显示5个QA对
3. 测试"上一页"、"下一页"按钮
4. 验证页码显示正确

#### 5. 导出功能测试
1. 点击"导出JSONL"按钮
2. 验证文件下载成功
3. 点击"导出Excel"按钮
4. 验证Excel文件下载成功（非压缩包）

### 登录模式测试

#### 1. 用户登录
1. 在登录页面选择用户
2. 输入密码
3. 点击"登录"按钮
4. 验证登录成功（注：当前登录功能存在问题，建议主要测试访客模式）

#### 2. 界面布局测试
1. 验证左侧导航栏和右侧工作台左右并列显示
2. 验证页面高度固定在浏览器窗口内
3. 验证左侧会话历史记录区域显示正常

## 测试数据

### 示例JSONL文件内容
创建一个名为 `test_qa_data.jsonl` 的文件，内容如下：

```jsonl
{"question": "什么是人工智能？", "answer": "人工智能（AI）是计算机科学的一个分支，旨在创建能够执行通常需要人类智能的任务的系统。"}
{"question": "机器学习和深度学习有什么区别？", "answer": "机器学习是人工智能的一个子集，而深度学习是机器学习的一个子集。深度学习使用神经网络来模拟人脑的工作方式。"}
{"question": "什么是自然语言处理？", "answer": "自然语言处理（NLP）是人工智能的一个分支，专注于使计算机能够理解、解释和生成人类语言。"}
{"question": "云计算的主要优势是什么？", "answer": "云计算的主要优势包括成本效益、可扩展性、灵活性、可靠性和安全性。"}
{"question": "什么是区块链技术？", "answer": "区块链是一种分布式账本技术，通过加密链接的区块来记录交易，确保数据的透明性和不可篡改性。"}
{"question": "什么是物联网？", "answer": "物联网（IoT）是指通过互联网连接的物理设备网络，这些设备可以收集和交换数据。"}
{"question": "大数据的特征是什么？", "answer": "大数据通常具有4V特征：Volume（体量大）、Velocity（速度快）、Variety（种类多）、Veracity（真实性）。"}
{"question": "什么是网络安全？", "answer": "网络安全是保护计算机系统、网络和数据免受数字攻击、损害或未经授权访问的实践。"}
{"question": "什么是DevOps？", "answer": "DevOps是一种软件开发方法，强调开发（Development）和运维（Operations）团队之间的协作和沟通。"}
{"question": "什么是微服务架构？", "answer": "微服务架构是一种将应用程序构建为一系列小型、独立服务的方法，每个服务都在自己的进程中运行。"}
```

## 验收标准

### 功能验收
- [ ] 访客模式按钮可以正常点击
- [ ] 文件上传功能正常工作
- [ ] QA对编辑功能正常工作
- [ ] 分页功能正常工作（每页5个QA对）
- [ ] JSONL导出功能正常工作
- [ ] Excel导出功能正常工作（直接导出文件，非压缩包）
- [ ] 页面布局左右并列显示
- [ ] 页面高度固定在标准浏览器大小内

### 界面验收
- [ ] 访客模式只显示工作台界面，无左侧导航
- [ ] 登录模式显示左侧导航和右侧工作台
- [ ] 上传文件后，上传容器隐藏，显示会话名称
- [ ] 分页控件显示正常，包含页码信息
- [ ] 编辑状态正确显示"有未保存的更改"提示

### 性能验收
- [ ] 页面加载时间 < 3秒
- [ ] 文件上传响应时间 < 5秒
- [ ] 编辑操作响应时间 < 1秒
- [ ] 导出操作响应时间 < 10秒

## 常见问题排查

### 1. 后端服务启动失败
**问题**：运行 `python3 src/main.py` 时出错
**解决方案**：
- 检查Python版本：`python3 --version`
- 检查依赖安装：`pip3 list`
- 检查端口占用：`lsof -i :5001`

### 2. 前端服务启动失败
**问题**：运行 `npm run dev` 时出错
**解决方案**：
- 检查Node.js版本：`node --version`
- 清除缓存：`npm cache clean --force`
- 重新安装依赖：`rm -rf node_modules && npm install --legacy-peer-deps`

### 3. 文件上传失败
**问题**：选择文件后无响应或报错
**解决方案**：
- 检查文件格式是否为JSONL
- 检查文件内容是否符合JSON格式
- 检查文件大小是否超过限制（10MB）

### 4. 页面布局异常
**问题**：左右布局显示不正常
**解决方案**：
- 刷新浏览器页面
- 检查浏览器控制台是否有错误
- 尝试使用不同浏览器

### 5. 导出功能异常
**问题**：点击导出按钮无响应
**解决方案**：
- 检查浏览器是否阻止了下载
- 检查后端服务是否正常运行
- 查看浏览器控制台错误信息

## 技术支持

### 日志查看
- **后端日志**：在后端服务运行的终端查看
- **前端日志**：打开浏览器开发者工具查看Console

### 调试模式
- 后端服务运行在调试模式，代码修改后会自动重启
- 前端服务支持热重载，修改后自动刷新页面

### 数据库查看
项目使用SQLite数据库，数据库文件位于项目根目录的 `qa_platform.db`

## 注意事项

1. **端口冲突**：确保5001和5173端口未被其他程序占用
2. **文件权限**：确保项目目录有读写权限
3. **网络访问**：确保防火墙允许相应端口的访问
4. **浏览器兼容性**：建议使用现代浏览器以获得最佳体验
5. **数据安全**：访客模式的数据仅在当前会话中有效，关闭浏览器后数据将丢失

## 更新日志

### v1.0.0 (2025-07-13)
- ✅ 修复访客模式按钮无法点击问题
- ✅ 优化登录用户界面布局为左右并列
- ✅ 实现工作台翻页模式
- ✅ 确保页面高度固定在标准浏览器大小内
- ✅ 优化文件导出功能
- ✅ 完善用户体验和界面设计

